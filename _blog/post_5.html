---
title: "Generate label footprints for Satellite Imagery: the Pythonic Way [Part 1]"
collection: blog
permalink: /blog/post_5
excerpt: 'Given an AOI of a satellite image, can we get the corresponding groundtruth labels with a some python code?'
date: 2018-02-19
tags:
  - GIS
  - Satellite Imagery
  - machine learning
  - Open Street Maps
  - Python
  - API
  - geoPandas
  - gdal
  - OSM
  - Bokeh
  - geoJSON
  
---

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>MathJax example</title>
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });  </script>
  
<style>
figure {
  text-align: center;
  font-style: italic;
  font-size: smaller;
  text-indent: 0;
  border: thin silver solid;
  margin: 0.5em;
  padding: 0.5em;
}
  
  pre {
white-space: pre-wrap;
white-space: -moz-pre-wrap;
white-space: -o-pre-wrap;
word-wrap: break-word;}

code {
font-family: Courier, 'New Courier', monospace;
font-size: 14px;}
  
  
</style>
</head>

<body>
  
<p>Suppose you have satellite imagery for an Area of Interest (AOI). You can do all sorts of analysis. But, with the advent of deep learning you want to 
  to some really cool stuff. But before that, you want to get the footprints of all the buildings in the Le Plateau area of Montreal or all the 
  roads in SoMA in San Francisco or perhaps you want to see where are all the general amentities in the Italian quarter in Boston. </p>
  
<p>Let us first see what we want to achieve</p>
 
<figure>
<img src="https://github.com/Pulkit-Khandelwal/pulkit-khandelwal.github.io/blob/master/_blog/ams.png?raw=true" alt="Satellite image of the city of Amsterdam" width="600" height="600" align="middle">
<figcaption>Fig 1. Satellite image of the city of Amsterdam</figcaption>
</figure>
  
<figure>
<img src="https://github.com/Pulkit-Khandelwal/pulkit-khandelwal.github.io/blob/master/_blog/amsterdam_highway.png?raw=true" alt="Highways in the city of Amsterdam" width="600" height="600" align="middle">
<figcaption>Fig 1. Highways in the city of Amsterdam</figcaption>
</figure>
  
<figure>
<img src="https://github.com/Pulkit-Khandelwal/pulkit-khandelwal.github.io/blob/master/_blog/ams_building_labels.png?raw=true" alt="Buildings in the city of Amsterdam" width="600" height="600" align="middle">
<figcaption>Fig 1. Buildings in the city of Amsterdam</figcaption>
</figure>
  

<p>So, you have the four coordinates of the AOI. You want to do the follwoing in order:
</p>
  
<h2>Tasks</h2>
<ol>
  <li>Get the orginal image of the AOI</li>
  <li>Get the footprint of all the amenities you are looking for (here, highways/roads)</li>
  <li>Then you want save this save an image</li>
  <li>You also want to overlay this on top of a map (Google Maps, perhaps?)</li>
  <li>But wait, you also want to save a geoJSON file of the region</li>
</ol>
  
<p> 
Go to geojson.io Once, you are there you have the choice to select an AOI using the cursor. Go to your faviurite city and draw an
 AOI. I have drawn one in Montreal (the city I am currently writing this post from). Once you have selected the AOI, go ahead and 
  save the coordinates as a geoJSON file. You can do that by using the Save scroll-down menu at the top left corner of the website.
 
Here is the geoJSON file that I got for roughly Montreal's Lower Plateau area. Fun fact: I love the cafe culture in this city!

  
</p>
  
   
<pre><code>
{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"type":"Polygon",
"coordinates":[[[-73.58076095581055,45.509474756808736],[-73.55835914611816,45.509474756808736],
[-73.55835914611816,45.52081177681294],[-73.58076095581055,45.52081177681294],[-73.58076095581055,45.509474756808736]]]}}]}

</code></pre>
  
  
<p>
 I have also included a screenshot below to make sure we have the right thing with us.

</p> 
  
   FIGUREEEE
  
<p>
Next, we should see a similar thing on Open Stret Map's API: turbo-pass.eu
Just as we did before, go ahead and select a region of interest. This time I am going with a small part of the financial
disctrict in San Francisco. 
But, this time we wil do a little bit more. On the menu bar at the top of the website, you should be an interesting option
named: Wizard. Click on that and feel free to explore in your free time. For now, type in building in the query box and then click on the

build and run option. You should see a code generated on the left side of your screen and it appears like this. Make
  sure you have got the same thing. 
  
  
  
<pre><code>
/*
This has been generated by the overpass-turbo wizard.
The original search was:
“building”
*/
[out:json][timeout:25];
// gather results
(
  // query part for: “building”
  node["building"]({{bbox}});
  way["building"]({{bbox}});
  relation["building"]({{bbox}});
);
// print results
out body;
>;
out skel qt;
</code></pre>
  
  
  
  
 FIGUREEEE.
  
What you have got is a code anippet which runs on the server and queries all the buildings in the given AOI.
  You can see that on the maps. The footprint of each of the building is shown as bounding boxes. Go ahead
  and zoom in to see the different buildings. Did you get something like this?


And now you are probably wondering can I save this data?
Ofcourse, we can! And we will do that in three different ways.

1. Let us get a geoJSON file just like we did before. To do that click on export and then save the file as a geoJSON.
  If you go through the file, you should see that there is tons of information out there.
Let us see:
  You get the coordinates of each building. Wow. What is more interesing is the additional information taht you get out of it.

  Here is my file. And the first few lines of the file....


2. Save this AOI as an image. Click on export and then select the save as png file option.
  
3. You can also open this on a map and get a weblink which you play around with later.
  
</p> 
  
  
 
  
  
  
  
  
  
</body>
</html>
